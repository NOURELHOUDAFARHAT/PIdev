<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>
        {% block title %}Welcome!{% endblock %}
    </title>

    {% block css %}
    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="{{ asset('assets/vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
    <!-- Bootstrap Icons CSS -->
    <link href="{{ asset('assets/vendor/bootstrap-icons/bootstrap-icons.css') }}" rel="stylesheet">
    <!-- Boxicons CSS -->
    <link href="{{ asset('assets/vendor/boxicons/css/boxicons.min.css') }}" rel="stylesheet">
    <!-- Quill CSS -->
    <link href="{{ asset('assets/vendor/quill/quill.snow.css') }}" rel="stylesheet">
    <link href="{{ asset('assets/vendor/quill/quill.bubble.css') }}" rel="stylesheet">
    <!-- Remixicon CSS -->
    <link href="{{ asset('assets/vendor/remixicon/remixicon.css') }}" rel="stylesheet">
    <!-- Simple DataTables CSS -->
    <link href="{{ asset('assets/vendor/simple-datatables/style.css') }}" rel="stylesheet">
    <!-- Main CSS -->
    <link href="{{ asset('assets/css/style.css') }}" rel="stylesheet">
    <style>
        .center-table {
            margin: 0 auto;
        }
    </style>
    {% endblock %}
</head>
<body>
<div class="container">
    <h1 class="text-center">Liste des utilisateurs</h1>

    <!-- Barre de recherche dynamique -->
    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Rechercher par nom ou numéro">

    <!-- Boutons de tri -->
    <button onclick="sortTable(0)">Trier par Nom</button>
    <button onclick="sortTable(1)">Trier par Prénom</button>
    <button onclick="sortTable(3)">Trier par Adresse</button>

    <table id="userTable" class="table table-bordered center-table">
        <thead>
        <tr>
            <th>Nom</th>
            <th>Prénom</th>
            <th>E-mail</th>
            <th>Adresse</th>
            <th>Sexe</th>
            <th>Edit</th>
            <th>Supprimer</th>
            <th>Statut</th>
            
        </tr>
        </thead>
        <tbody>
        {% for user in users %}
            <tr>
                <td>{{ user.nom }}</td>
                <td>{{ user.prenom }}</td>
                <td>{{ user.email }}</td>
                <td>{{ user.adresse }}</td>
                <td>{{ user.sexe }}</td>
                <td>
                    <a href="{{ path('app_user_edit', {'id': user.id}) }}"><span class="badge bg-primary">Edit</span></a>
                </td>
                <td>
                    <form action="{{ path('app_delete', {'id': user.id}) }}" method="post">
                        <input type="hidden" name="_method" value="POST">
                        <button type="submit" class="badge bg-warning" onclick="return confirm('Are you sure you want to delete this user?')">Supprimer</button>
                    </form>
                </td>
                <td>
                    <form action="#" method="post">
                        <input type="radio" name="status" value="actif">
                        <span class="badge bg-success">Actif</span>
                        <input type="radio" name="status" value="desactiver">
                        <span class="badge bg-danger">Désactiver</span>
                    </form>
                </td>
                
            </tr>
        {% endfor %}
        </tbody>
    </table>

</div>
</body>
<script>
    function searchTable() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("searchInput");
        filter = input.value.toUpperCase();
        table = document.getElementById("userTable");
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            var tdNom = tr[i].getElementsByTagName("td")[0]; // 0 correspond à l'index de la colonne "nom"
            var tdNumero = tr[i].getElementsByTagName("td")[3]; // 3 correspond à l'index de la colonne "prix"

            if (tdNom && tdNumero) {
                var txtValueNom = tdNom.textContent || tdNom.innerText;
                var txtValueNumero = tdNumero.textContent || tdNumero.innerText;

                if (txtValueNom.toUpperCase().indexOf(filter) > -1 || txtValueNumero.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

    var sortOrder = 1; // 1 for ascending, -1 for descending

    function sortTable(columnIndex) {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("userTable");
        switching = true;
        while (switching) {
            switching = false;
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("TD")[columnIndex];
                y = rows[i + 1].getElementsByTagName("TD")[columnIndex];
                if (sortOrder === 1 && x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                } else if (sortOrder === -1 && x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                }
            }
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
            }
        }
        // Toggle sortOrder for the next click
        sortOrder = -sortOrder;
    }
</script>
</html>
