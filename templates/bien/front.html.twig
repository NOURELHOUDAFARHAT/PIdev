{% extends 'base.html.twig' %}

{% block body %}

<div class="service">
    <div class="container">
        <div class="section-header text-center">
            <h4 style="margin-top:50px; margin-bottom:50px;">Liste des Biens</h4>
        </div>
        
        <!-- Contrôles de filtrage -->
        <form method="GET">
            <div class="row mb-3">
                <div class="col">
                    <label for="filterType" class="form-label">Filtrer par Type:</label>
                    <select class="form-select" id="filterType" name="type">
                        <option value="">Tous les types</option>
                        <option value="Villa">Villa</option>
                        <option value="Appartement">Appartement</option>
                        <option value="Studio">Studio</option>
                    </select>
                </div>
                <div class="col">
                    <label for="filterPrice" class="form-label">Filtrer par Prix:</label>
                    <select class="form-select" id="filterPrice" name="price">
                        <option value="">Tous les prix</option>
                        <option value="800">Moins de 800 dinars</option>
                        <option value="1500">Moins de 1500 dinars</option>
                    </select>
                </div>
                <div class="col align-self-end">
                    <button type="submit" class="btn btn-primary">Filtrer</button>
                </div>
            </div>
        </form>
        
        <div class="row">
            {% for bien in biens %}
                <!-- Vérifier les filtres -->
                {% if (app.request.query.get('type') is null or app.request.query.get('type') == bien.type) and
                      (app.request.query.get('price') is null or bien.prix <= app.request.query.get('price')) %}
                    <div class="col-lg-4 col-md-6 mb-4">
                        <div class="service-item">
                            <a href="{{ path('app_bien_show', {'refB': bien.refB}) }}">
                                <img src="{{ asset('uploads/' ~ bien.image)}}" style="width:360px; height:250px;" class="d-flex mx-3 py-2 border border-primary bg-light rounded-pill" data-bs-toggle="pill" alt="">
                            </a>
                            <center><h2>{{ bien.name }}</h2></center>
                            <p><strong style="color:#696969">Type:</strong> {{ bien.type }}</p>
                            <p><strong style="color:#696969">Nombre de Chambres:</strong> {{ bien.nbrChambre }}</p>
                            <p><strong style="color:#696969">Prix:</strong> {{ bien.prix }} dinars</p>
                            <center>
                                <a href="{{ path('app_visite_new', {'refB': bien.refB}) }}" class="btn btn-primary">Planifier une Visite</a>
                            </center>

                            <br>
                            <br>

                           
                        </div>
                    </div>
                    
                {% endif %}
            {% else %}
                <div class="col">
                    <p class="text-center">Aucun bien trouvé.</p>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
<iframe width="350" height="430" allow="microphone;" src="https://console.dialogflow.com/api-client/demo/embedded/42d2d1de-9fe2-46fa-b6e9-a4aa6897ae77"></iframe>
<div id="google_translate_element"></div>

<script type="text/javascript">
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
    }
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>

<df-messenger
  intent="Default Welcome Intent"
  chat-title="chatBien"
  agent-id="nour-sh9g"
  language-code="fr"
></df-messenger>

<br>

{% endblock %}
